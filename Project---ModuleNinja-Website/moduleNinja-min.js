var mn,moduleNinja;mn=moduleNinja=function dg(){function Required(){}function required(){return new Required}function Accept(e){var t=this;"use strict";if(typeof !e==="string"){throw new TypeError("Can not register a type with a name that is not a string.")}t.value=e}function accept(e){return new Accept(e)}function Type(e,t){var n=this;"use strict";if(!typeof e==="string"){throw new TypeError("Can not register a type with a name that is not a string.")}runSyntaxNameCheck(e);if(!(t instanceof Function)){throw new TypeError("Can not register a type that is not a function.")}n.name=e;n.type=t}function type(e,t){return new Type(e,t)}function runSyntaxNameCheck(e){if(typeof e!=="string"){throw new TypeError("Name must be of type string. '"+typeof e+"' was used instead.")}if(e.length===0){throw new SyntaxError("Name can not be an empty string")}if(("A">e[0]||e[0]>"Z")&&("a">e[0]||e[0]>"z")){throw new SyntaxError("Name must start with a latin letter. '"+e+"' is not valid.")}for(var t=1;t<e.length;t++){if(("A">e[t]||e[t]>"Z")&&("a">e[t]||e[t]>"z")&&"1"!==e[t]&&"2"!==e[t]&&"3"!==e[t]&&"4"!==e[t]&&"5"!==e[t]&&"6"!==e[t]&&"7"!==e[t]&&"8"!==e[t]&&"9"!==e[t]&&"0"!==e[t]){throw new SyntaxError("Name can contain only Latin letters and numbers. '"+e+"' is not valid.")}}}function ModuleConstructor(){var e=this;"use strict";e._forbiddenNames=[];e._forbiddenInitNames=[];e._mnConstructorPrivates={};e._mnConstructorPublics={};e._mnConstructorInitializators={}}function generateModuleCode(){var e=this;var t=makePrivatesObject.call(e);var n=makePublicsObject.call(e);var r=makeInitObject.call(e,true);var i=[];i.push("(function () {");if(t.isUsed){i.push("//privates\n"+t.code)}if(n.isUsed){i.push("//publics\n"+n.code)}if(r.isUsed){i.push("//initialization logic\n"+"var initializator = "+r.code);i.push("//initialization calls\n"+r.list.join("\n"))}if(n.isUsed){i.push("//retuned object\n"+n.list.join("\n"))}i.push("} ());");return i.join("\n\n")}function ClassConstructor(){var e=this;"use strict";e._forbiddenNames=[];e._forbiddenPrivateNames=["types","validate","initializator"];e._forbiddenValidationNames=[];e._forbiddenInitNames=[];e._forbiddenTypeNames=["Parent"];for(var t in builtInValidators){e._forbiddenValidationNames.push(t)}e._mnConstructorName="UnnamedClass";e._mnConstructorAccepts={};e._mnConstructorProps={};e._mnConstructorKnownTypes={};e._mnConstructorInitializators={};e._mnConstructorAccessors={};e._mnConstructorValidators={};e._mnConstructorExtensions={};e._mnConstructorConstants={};e._mnConstructorPrivates={};e._dgConstuctorSettings={useStrict:true}}function makeTypesObject(){var e=this;var t={};var n=[];var r=[];r.push("{");for(var i in e._mnConstructorKnownTypes){n.push(i);r.push(" "+i+": "+i+",")}r[r.length-1]=r[r.length-1].substr(0,r[r.length-1].length-1);r.push("}");t.code=r.join("\n");t.list=n;t.isUsed=n.length>0;return t}function makeValidatorObject(){var e=this;var t={};var n=[];var r=[];r.push("{");for(var i in e._mnConstructorValidators){n.push(i);r.push(" "+i+": "+e._mnConstructorValidators[i]+",")}r[r.length-1]=r[r.length-1].substr(0,r[r.length-1].length-1);r.push("}");t.code=r.join("\n");t.list=n;t.isUsed=n.length>0;return t}function makePrivatesObject(){var e=this;var t={};var n=[];var r=[];for(var i in e._mnConstructorPrivates){n.push(i);if(typeof e._mnConstructorPrivates[i]==="string"){r.push("  "+"var "+i+" = '"+e._mnConstructorPrivates[i]+"';")}else if(e._mnConstructorPrivates[i]instanceof Function){r.push("    "+"var "+i+" = "+e._mnConstructorPrivates[i]+";")}else if(e._mnConstructorPrivates[i]instanceof Object){r.push("    "+"var "+i+" = "+JSON.stringify(e._mnConstructorPrivates[i])+";")}else{r.push(" "+"var "+i+" = "+e._mnConstructorPrivates[i]+";")}}t.list=n;t.code=r.join("\n");t.isUsed=n.length>0;return t}function makePublicsObject(){var e=this;var t={};var n=[];var r=[];n.push("    return {");for(var i in e._mnConstructorPublics){n.push("       "+i+": "+i+",");if(typeof e._mnConstructorPublics[i]==="string"){r.push("   "+"var "+i+" = '"+e._mnConstructorPublics[i]+"';")}else if(e._mnConstructorPublics[i]instanceof Function){r.push("  "+"var "+i+" = "+e._mnConstructorPublics[i]+";")}else if(e._mnConstructorPublics[i]instanceof Object){r.push("  "+"var "+i+" = "+JSON.stringify(e._mnConstructorPublics[i])+";")}else{r.push("  "+"var "+i+" = "+e._mnConstructorPublics[i]+";")}}n[n.length-1]=n[n.length-1].substr(0,n[n.length-1].length-1);n.push(" };");t.list=n;t.code=r.join("\n");t.isUsed=r.length>0;return t}function makeInitObject(e){var t=this;var n={};var r=[];var i=[];i.push("{");for(var s in t._mnConstructorInitializators){r.push("   "+"initializator['"+s+"']"+(e===true?"()":".call(this)")+";");i.push("  "+s+" : "+t._mnConstructorInitializators[s]+",")}i[i.length-1]=i[i.length-1].substr(0,i[i.length-1].length-1);i.push("}");n.list=r;n.code=i.join("\n");n.isUsed=r.length>0;return n}function makeAcceptObject(){var e=this;var t={};var n=[];var r=[];for(var i in e._mnConstructorAccepts){n.push(i);if(e._mnConstructorAccepts[i]instanceof Required){r.push("    "+"if("+i+" === undefined){\n"+"        "+"throw new ReferenceError('"+i+" is not defined on object initialization');\n"+"      "+"}")}else if(e._mnConstructorAccepts[i]instanceof Accept){r.push("    "+"if("+i+" === undefined){\n"+"        "+i+" = "+e._mnConstructorAccepts[i].value+";\n"+"      "+"}")}else if(typeof e._mnConstructorAccepts[i]==="string"){r.push("   "+"if("+i+" === undefined){\n"+"        "+i+" = '"+e._mnConstructorAccepts[i]+"';\n"+"      "+"}")}else{r.push("    "+"if("+i+" === undefined){\n"+"        "+i+" = "+JSON.stringify(e._mnConstructorAccepts[i])+";\n"+"        "+"}")}}t.list=n;t.code=r.join("\n");t.isUsed=n.length>0;return t}function makePropObject(){var e=this;var t={};var n=[];var r=[];var i=[];for(var s in e._mnConstructorProps){n.push(s);r.push("   "+"this._"+s+" = undefined;");if(typeof e._mnConstructorProps[s]==="string"){i.push("   "+"this."+s+"('"+e._mnConstructorProps[s]+"')")}else if(e._mnConstructorProps[s]instanceof Accept){i.push(" "+"this."+s+"("+e._mnConstructorProps[s].value+")")}else if(e._mnConstructorProps[s]instanceof Function){i.push("   "+"this."+s+"("+e._mnConstructorProps[s]+")")}else if(e._mnConstructorProps[s]!==undefined){i.push("    "+"this."+s+"("+JSON.stringify(e._mnConstructorProps[s])+")")}}t.list=n;t.code=r.join("\n")+(i.length>0?"\n\n"+i.join("\n"):"");t.isUsed=n.length>0;return t}function makeParentObject(){var e=this;var t={};var n=[];if(e._mnConstructorKnownTypes.Parent!==undefined){n.push("Parent")}t.list=n;t.code=e._mnConstructorName+".prototype = new types.Parent();";t.isUsed=n.length>0;return t}function makeAccessorsObject(){var e=this;var t={};var n=[];var r=[];for(var i in e._mnConstructorAccessors){n.push(i);if(typeof e._mnConstructorAccessors[i]==="string"){accessorsString=e._mnConstructorName+".prototype."+i+" = function "+i+"(value) {\n"+"   "+"return validate."+e._mnConstructorAccessors[i]+'.call(this, "_'+i+'", value);\n'+"}";r.push(accessorsString)}else if(e._mnConstructorAccessors[i]instanceof Type){accessorsString=e._mnConstructorName+".prototype."+i+" = function "+i+"(value) {\n"+"  "+'return validate.type.call(this, "_'+i+'", value, types.'+e._mnConstructorAccessors[i].name+");\n"+"}";r.push(accessorsString)}else{r.push(e._mnConstructorName+".prototype."+i+" = "+e._mnConstructorAccessors[i])}}t.list=n;t.code=r.join("\n");t.isUsed=n.length>0;return t}function makeExtensionsObject(){var e=this;var t={};var n=[];var r=[];for(var i in e._mnConstructorExtensions){n.push(i);r.push("  "+e._mnConstructorName+".prototype."+i+" = "+e._mnConstructorExtensions[i])}t.list=n;t.code=r.join("\n");t.isUsed=n.length>0;return t}function generateClassCode(){var e=this;var t=makeTypesObject.call(e);var n=makeValidatorObject.call(e);var r=makePrivatesObject.call(e);var i=makeInitObject.call(e);var s=makeAcceptObject.call(e);var o=makePropObject.call(e);var u=makeParentObject.call(e);var a=makeAccessorsObject.call(e);var f=makeExtensionsObject.call(e);var l=[];if(f.isUsed){l.push("(function("+(t.isUsed?t.list.join(", "):"")+") {")}l.push((f.isUsed?"var "+e._mnConstructorName+" = ":"")+"(function("+(t.isUsed?t.list.join(", "):"")+") {");if(t.isUsed){l.push("//types\n"+"var types = "+t.code)}if(n.isUsed){l.push("//validation\n"+"var validate = "+n.code)}if(r.isUsed){l.push(r.code)}if(i.isUsed){l.push("//init\n"+"var initializator = "+i.code)}l.push("function "+e._mnConstructorName+"("+(s.isUsed?s.list.join(", "):"")+") {");if(e._dgConstuctorSettings.useStrict){l.push("   "+"'use strict';")}if(s.isUsed){l.push("    "+"//accept checks\n"+s.code)}if(o.isUsed){l.push(" "+"//props\n"+o.code)}if(i.isUsed){l.push(" "+"//initialization\n"+i.list.join("\n"))}l.push("}");if(u.isUsed){l.push("//inheratnece\n"+u.code)}if(a.isUsed){l.push("//accessor functions\n"+a.code)}l.push("return "+e._mnConstructorName+";");l.push("}("+(t.isUsed?t.list.join(", "):"")+"));");if(f.isUsed){l.push("//extending function\n"+f.code);l.push("return "+e._mnConstructorName+";");l.push("}("+(t.isUsed?t.list.join(", "):"")+"));")}return l.join("\n\n")}function forAllPublicArguments(e,t,n){var r=this;var i;var s=[];if(e instanceof Object){for(i in e){var o={name:i,validation:e[i]};s.push(o)}}else{for(i=0;i<r.arguments.length;i++){s.push(r.arguments[i])}}for(i=0;i<s.length;i++){if(typeof s[i]==="string"){t.call(n,s[i])}else{t.call(n,s[i].name,s[i].validation)}}}function classCreator(e){var t=new ClassConstructor;forAllPublicArguments.call(classCreator,e,t.arg,t);return t}function moduleCreator(e){var t=new ModuleConstructor;forAllPublicArguments.call(moduleCreator,e,t.public,t);return t}function cloneCreator(e,t){var n;var r;if(e===undefined){return e}else if(typeof e==="string"||typeof e==="number"||typeof e==="boolean"||typeof e==="null"){return e}else if(e instanceof Array){n=[];for(var r=0;r<e.length;r++){n[r]=cloneCreator(e[r],t)}}else if(e instanceof Function){return e}else if(e instanceof Object){if(t===true){n=new e.constructor}else{n={}}for(r in e){n[r]=cloneCreator(e[r],t)}}else{throw new Error("Something unexpected happened")}return n}var builtInValidators={any:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){n[e]=t;return n}else{return n[e]}},string:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(typeof t==="string"){n[e]=t;return n}else{throw new TypeError(e+" expected a value of type 'string'. Got type '"+typeof t+"'")}}else{return n[e]}},"char":function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(typeof t==="string"&&t.length===1){n[e]=t;return n}else{throw new TypeError(e+" expected a value of type 'string' with length of 1. Got type '"+typeof t+"'")}}else{return n[e]}},nonEmptyString:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(typeof t==="string"&&t.length>0){n[e]=t;return n}else{throw new TypeError(e+" expected a value of type 'string' with length bigger than 0. Got type '"+typeof t+"'")}}else{return n[e]}},bool:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not a valid target, or is not defined")}if(t!==undefined){if(t===false||t===true){n[e]=t;return n}else{throw new TypeError(e+" expected a value of type 'string' with length of 1. Got type '"+typeof t+"'")}}else{return n[e]}},number:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(typeof t==="number"){n[e]=t;return n}else{throw new TypeError(e+" expected a value of type 'number'. Got type '"+typeof t+"'")}}else{return n[e]}},"int":function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(typeof t==="number"){n[e]=Math.floor(t);return n}else{throw new TypeError(e+" expected a value of type 'number'. Got type '"+typeof t+"'")}}else{return n[e]}},positiveNumber:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(typeof t==="number"&&t>=0){n[e]=t;return n}else{throw new TypeError(e+" expected a value of type 'number'. Got type '"+typeof t+"'")}}else{return n[e]}},positiveInt:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(typeof t==="number"&&t>=0){n[e]=Math.floor(t);return n}else{throw new TypeError(e+" expected a value of type 'number'. Got type '"+typeof t+"'")}}else{return n[e]}},array:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(t instanceof Array){n[e]=t;return n}else{throw new TypeError(e+" expected instance of 'Array'. Got type '"+typeof t+"'")}}else{return n[e]}},object:function(e,t){var n=this;if(!e||!n.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(t instanceof Object){n[e]=t;return n}else{throw new TypeError(e+" expected instance of 'Object'. Got type '"+typeof t+"'")}}else{return n[e]}},type:function(e,t,n){var r=this;if(!e||!r.hasOwnProperty(e)){throw new ReferenceError(e+" is not defined")}if(t!==undefined){if(t instanceof n){r[e]=t;return r}else{throw new TypeError(e+" expected instance of '"+n.name+"'. Got type '"+typeof t+"'")}}else{return r[e]}}};ModuleConstructor.prototype.public=function(e,t){var n=this;runSyntaxNameCheck(e);if(this._forbiddenNames.indexOf(e)!==-1){throw new ReferenceError("Public name '"+type.name+"' is already being used, or is a reserved word")}n._mnConstructorPublics[e]=t;return n};ModuleConstructor.prototype.private=function(e,t){var n=this;runSyntaxNameCheck(e);if(this._forbiddenNames.indexOf(e)!==-1){throw new ReferenceError("Private name '"+type.name+"' is already being used, or is a reserved word")}n._mnConstructorPrivates[e]=t;return n};ModuleConstructor.prototype.initializator=function(e,t){var n=this;runSyntaxNameCheck(e);if(n._forbiddenInitNames.indexOf(e)!==-1){throw new ReferenceError("Initializator name "+e+" is already being used.")}if(!(t instanceof Function)){throw new TypeError("Initializator "+e+" is not a function.")}n._mnConstructorInitializators[e]=t;n._forbiddenInitNames.push(e);return n};ModuleConstructor.prototype.onInit=function(e,t){return this.initializator(e,t)};ModuleConstructor.prototype.init=function(e,t){return this.initializator(e,t)};ModuleConstructor.prototype.finalize=function(){var self=this;var code=generateModuleCode.call(self);var result=eval(code);return result};ModuleConstructor.prototype.extractCode=function(){return generateModuleCode.call(this)};ModuleConstructor.prototype.toString=ModuleConstructor.prototype.extractCode;ModuleConstructor.prototype.stringify=ModuleConstructor.prototype.extractCode;ClassConstructor.prototype.className=function(e){var t=this;runSyntaxNameCheck(e);t._mnConstructorName=e;return t};ClassConstructor.prototype.useStrict=function(e){var t=this;if(e===undefined){throw new ReferenceError("Can not use undefined to set class setting 'useStrict'")}if(typeof e!=="boolean"){throw new TypeError("Can not use "+typeof e+" to set class setting 'useStrict'")}t._dgConstuctorSettings.useStrict=e;return t};ClassConstructor.prototype.childOf=function(e){var t=this;if(!(e instanceof Function)){throw new TypeError("The given parent is not a function.")}t._mnConstructorKnownTypes.Parent=e;return t};ClassConstructor.prototype.arg=function(e,t,n){var r=this;if(!t){return r.arg(e,"any",n)}runSyntaxNameCheck(e);r.accepts(e,n);r.prop(e,t,new Accept(e));return r};ClassConstructor.prototype.attr=function(e,t,n){return this.arg(e,t,n)};ClassConstructor.prototype.accepts=function(e,t){var n=this;runSyntaxNameCheck(e);if(n._mnConstructorAccepts[e]){throw new ReferenceError("Name "+e+" is already being used.")}if(t===undefined){return n.accepts(e,new Required)}n._mnConstructorAccepts[e]=t;return n};ClassConstructor.prototype.accept=function(e,t){return this.accepts(e,t)};ClassConstructor.prototype.prop=function(e,t,n){var r=this;if(t===undefined){return r.prop(e,"any",n)}runSyntaxNameCheck(e);if(r._forbiddenNames.indexOf(e)!==-1){throw new ReferenceError("Name "+e+" is already being used.")}r._mnConstructorProps[e]=n;if(typeof t==="string"){if(t.substr(0,4)==="type"){propValidationSplit=t.split(" ");if(propValidationSplit.length!==2){throw new SyntaxError("Invalid type validation command string: "+t)}if(r._mnConstructorKnownTypes[propValidationSplit[1]]){return r.prop(e,new Type(propValidationSplit[1],r._mnConstructorKnownTypes[propValidationSplit[1]]),n)}else{throw new ReferenceError("Invalid type validation command string: "+t)}}else if(r._mnConstructorValidators[t]){}else if(builtInValidators[t]){r._mnConstructorValidators[t]=builtInValidators[t]}else{throw new ReferenceError("Invalid validation command string: "+t)}}else if(t instanceof Type){if(!(r._mnConstructorKnownTypes[t.name]!==undefined)){r.knownType(t)}r._mnConstructorValidators.type=builtInValidators.type}r._mnConstructorAccessors[e]=t;r._forbiddenNames.push("_"+e);r._forbiddenNames.push(e);return r};ClassConstructor.prototype.initializator=function(e,t){var n=this;runSyntaxNameCheck(e);if(n._forbiddenInitNames.indexOf(e)!==-1){throw new ReferenceError("Initializator name "+e+" is already being used.")}if(!(t instanceof Function)){throw new TypeError("Initializator "+e+" is not a function.")}n._mnConstructorInitializators[e]=t;n._forbiddenInitNames.push(e);return n};ClassConstructor.prototype.onInit=function(e,t){return this.initializator(e,t)};ClassConstructor.prototype.init=function(e,t){return this.initializator(e,t)};ClassConstructor.prototype.accessor=function(e,t){var n=this;runSyntaxNameCheck(e);if(n._forbiddenNames.indexOf(e)!==-1){throw new ReferenceError("Accessor name "+e+" is already being used.")}if(!(t instanceof Function)){throw new TypeError("Accessor "+e+" is not a function.")}n._mnConstructorAccessors[e]=t;n._forbiddenNames.push(e);return n};ClassConstructor.prototype.function=function(e,t){return this.accessor(e,t)};ClassConstructor.prototype.extension=function(e,t){var n=this;runSyntaxNameCheck(e);if(n._forbiddenNames.indexOf(e)!==-1){throw new ReferenceError("Function name "+e+" is already being used.")}if(!(t instanceof Function)){throw new TypeError("Extension "+e+" is not a function.")}n._mnConstructorExtensions[e]=t;n._forbiddenNames.push(e);return n};ClassConstructor.prototype.knownType=function(e){var t=this;if(e instanceof Type){if(t._forbiddenTypeNames.indexOf(e.name)!==-1){throw new ReferenceError("Type name "+e.name+" is already being used, or is a reserved word")}t._mnConstructorKnownTypes[e.name]=e.type;t._forbiddenTypeNames.push(e.name)}else{throw new TypeError("Unrecognised type. Use moduleNinja's .type() to wrap and name the type you want to be known in the program.")}return t};ClassConstructor.prototype.private=function(e,t){var n=this;runSyntaxNameCheck(e);if(n._forbiddenPrivateNames.indexOf(e)!==-1){throw new ReferenceError("Private name "+e+" is already being used, or is a reserved word.")}n._mnConstructorPrivates[e]=t;n._forbiddenPrivateNames.push(e);return n};ClassConstructor.prototype.const=function(e,t){return this.private(e,t)};ClassConstructor.prototype.validator=function(e,t){var n=this;runSyntaxNameCheck(e);if(n._forbiddenValidationNames.indexOf(e)!==-1){throw new ReferenceError("Validator name '"+e+"' is already being used, or is a reserved word.")}if(!(t instanceof Function)){throw new TypeError("Validator "+e+" is not a function")}n._mnConstructorValidators[e]=t;n._forbiddenValidationNames.push(e);return n};ClassConstructor.prototype.finalize=function(){var self=this;var i;var Result;var _finalizedString=generateClassCode.call(self);for(i in self._mnConstructorKnownTypes){var _nextVariavleString="var "+i+" = self._mnConstructorKnownTypes."+i+";";eval(_nextVariavleString)}Result=eval(_finalizedString);return Result};ClassConstructor.prototype.extractCode=function(){return generateClassCode.call(this)};ClassConstructor.prototype.toString=ClassConstructor.prototype.extractCode;ClassConstructor.prototype.stringify=ClassConstructor.prototype.extractCode;return{module:moduleCreator,"class":classCreator,clone:cloneCreator,type:type,accept:accept,literal:accept,required:required}}()